(function(){"use strict";var e={190:function(e,t,a){var l=a(5130),r=a(6768),n=a(4232);const i={id:"app",class:"container mt-5"},o={class:"col-md-4"},c={class:"form-group"},s=["value"],d={key:0},u={key:1,class:"row"},p={class:"col-md-8"},v={class:"table-responsive"},g={class:"table table-striped table-bordered table-hover"},k={class:"pagination mt-4"},h={"aria-label":"Page navigation"},m={class:"pagination"},L=["onClick"],f={class:"col-md-4"},b={class:"analytics mt-4"},y={class:"row"},C={key:0,class:"col-md-12 mb-3"},_={class:"card"},E={class:"card-body"},x={class:"card-text"},O={class:"col-md-12 mb-3"},P={class:"card"},D={class:"card-body"},w={class:"card-text"},A={class:"col-md-12 mb-3"},B={class:"card"},S={class:"card-body"},$={class:"card-text"},M={class:""};function T(e,t,a,T,X,j){const H=(0,r.g2)("CO2Chart");return(0,r.uX)(),(0,r.CE)("div",i,[(0,r.Lk)("div",o,[(0,r.Lk)("div",c,[t[4]||(t[4]=(0,r.Lk)("label",{for:"buildingSelect"},"Select Building",-1)),(0,r.bo)((0,r.Lk)("select",{class:"form-control",id:"buildingSelect","onUpdate:modelValue":t[0]||(t[0]=e=>T.selectedBuilding=e),onChange:t[1]||(t[1]=(...e)=>T.filterByBuilding&&T.filterByBuilding(...e))},[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(T.buildings,(e=>((0,r.uX)(),(0,r.CE)("option",{key:e.id,value:e.id},(0,n.v_)(e.name),9,s)))),128))],544),[[l.u1,T.selectedBuilding]])])]),e.loading?((0,r.uX)(),(0,r.CE)("div",d,t[5]||(t[5]=[(0,r.Lk)("p",null,"Loading data, please wait...",-1)]))):(0,r.Q3)("",!0),e.loading?(0,r.Q3)("",!0):((0,r.uX)(),(0,r.CE)("div",u,[(0,r.Lk)("div",p,[(0,r.Lk)("div",v,[(0,r.Lk)("table",g,[t[6]||(t[6]=(0,r.Lk)("thead",{class:"thead-dark"},[(0,r.Lk)("tr",null,[(0,r.Lk)("th",{scope:"col"},"#"),(0,r.Lk)("th",{scope:"col"},"ATTEC ID"),(0,r.Lk)("th",{scope:"col"},"Lora Address"),(0,r.Lk)("th",{scope:"col"},"Occupancy"),(0,r.Lk)("th",{scope:"col"},"Temp (°C)"),(0,r.Lk)("th",{scope:"col"},"Noise (dB)"),(0,r.Lk)("th",{scope:"col"},"CO2 (ppm)"),(0,r.Lk)("th",{scope:"col"},"AQ 1"),(0,r.Lk)("th",{scope:"col"},"AQ 2"),(0,r.Lk)("th",{scope:"col"},"Humidity (%)"),(0,r.Lk)("th",{scope:"col"},"Pressure (hPa)"),(0,r.Lk)("th",{scope:"col"},"Lux"),(0,r.Lk)("th",{scope:"col"},"Bearing (°)"),(0,r.Lk)("th",{scope:"col"},"Time (YYYY-MM-DD HH:mm:ss)"),(0,r.Lk)("th",{scope:"col"},"Device UUID"),(0,r.Lk)("th",{scope:"col"},"Host MCU"),(0,r.Lk)("th",{scope:"col"},"Lora MCU"),(0,r.Lk)("th",{scope:"col"},"EeDsp")])],-1)),(0,r.Lk)("tbody",null,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(T.paginatedData,((e,t)=>((0,r.uX)(),(0,r.CE)("tr",{key:e.id},[(0,r.Lk)("td",null,(0,n.v_)((T.currentPage-1)*T.itemsPerPage+t+1),1),(0,r.Lk)("td",null,(0,n.v_)(e.detail.ateccid),1),(0,r.Lk)("td",null,(0,n.v_)(e.detail.physicalsensorid),1),(0,r.Lk)("td",null,(0,n.v_)(e.detail.occupancy),1),(0,r.Lk)("td",null,(0,n.v_)(e.detail.temperature),1),(0,r.Lk)("td",null,(0,n.v_)(e.detail.noise),1),(0,r.Lk)("td",null,(0,n.v_)(e.detail.co2),1),(0,r.Lk)("td",null,(0,n.v_)(e.detail.aqi1),1),(0,r.Lk)("td",null,(0,n.v_)(e.detail.aqi2),1),(0,r.Lk)("td",null,(0,n.v_)(e.detail.humid),1),(0,r.Lk)("td",null,(0,n.v_)(e.detail.pressure),1),(0,r.Lk)("td",null,(0,n.v_)(e.detail.lux),1),(0,r.Lk)("td",null,(0,n.v_)(e.detail.bearing),1),(0,r.Lk)("td",null,(0,n.v_)(T.formatDate(e.updated)),1),(0,r.Lk)("td",null,(0,n.v_)(e.detail.deviceid),1),(0,r.Lk)("td",null,(0,n.v_)(e.deviceCache?.shadow_event_document_json?.current?.state?.reported?.softwareRevision?.hostMcu),1),(0,r.Lk)("td",null,(0,n.v_)(e.deviceCache?.shadow_event_document_json?.current?.state?.reported?.softwareRevision?.loraMcu),1),(0,r.Lk)("td",null,(0,n.v_)(e.deviceCache?.shadow_event_document_json?.current?.state?.reported?.softwareRevision?.eeDsp),1)])))),128))])])]),(0,r.Lk)("div",k,[(0,r.Lk)("nav",h,[(0,r.Lk)("ul",m,[(0,r.Lk)("li",{class:(0,n.C4)(["page-item",{disabled:1===T.currentPage}])},[(0,r.Lk)("a",{class:"page-link",onClick:t[2]||(t[2]=(0,l.D$)((e=>T.currentPage--),["prevent"]))},"Previous")],2),((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(T.totalPages,(e=>((0,r.uX)(),(0,r.CE)("li",{class:(0,n.C4)(["page-item",{active:T.currentPage===e}]),key:e},[(0,r.Lk)("a",{class:"page-link",onClick:(0,l.D$)((t=>T.currentPage=e),["prevent"])},(0,n.v_)(e),9,L)],2)))),128)),(0,r.Lk)("li",{class:(0,n.C4)(["page-item",{disabled:T.currentPage===T.totalPages}])},[(0,r.Lk)("a",{class:"page-link",onClick:t[3]||(t[3]=(0,l.D$)((e=>T.currentPage++),["prevent"]))},"Next")],2)])])])]),(0,r.Lk)("div",f,[(0,r.Lk)("div",b,[t[10]||(t[10]=(0,r.Lk)("h3",{class:"text-center"},"Analytics",-1)),(0,r.Lk)("div",y,[T.averageTemperature||T.averageHumidity||T.maxCO2?((0,r.uX)(),(0,r.CE)("div",C,[(0,r.Lk)("div",_,[(0,r.Lk)("div",E,[t[7]||(t[7]=(0,r.Lk)("h5",{class:"card-title"},"Average Temperature (°C)",-1)),(0,r.Lk)("p",x,(0,n.v_)(T.averageTemperature.toFixed(2)),1)])])])):(0,r.Q3)("",!0),(0,r.Lk)("div",O,[(0,r.Lk)("div",P,[(0,r.Lk)("div",D,[t[8]||(t[8]=(0,r.Lk)("h5",{class:"card-title"},"Average Humidity (%)",-1)),(0,r.Lk)("p",w,(0,n.v_)(T.averageHumidity.toFixed(2)),1)])])]),(0,r.Lk)("div",A,[(0,r.Lk)("div",B,[(0,r.Lk)("div",S,[t[9]||(t[9]=(0,r.Lk)("h5",{class:"card-title"},"Maximum CO2 (ppm)",-1)),(0,r.Lk)("p",$,(0,n.v_)(T.maxCO2),1)])])])])]),(0,r.Lk)("div",M,[t[11]||(t[11]=(0,r.Lk)("h3",{class:"text-center"},"CO2 Levels Over Time",-1)),T.co2Data.length>0&&T.timestamps.length>0?((0,r.uX)(),(0,r.Wv)(H,{key:0,co2Data:T.co2Data,timestamps:T.timestamps,class:"",style:{height:"1000px"}},null,8,["co2Data","timestamps"])):(0,r.Q3)("",!0)])])]))])}a(4979);var X=a(4373),j=a(144);function H(e,t,a,l,n,i){return(0,r.uX)(),(0,r.CE)("div",null,t[0]||(t[0]=[(0,r.Lk)("canvas",{id:"co2Chart"},null,-1)]))}var K=a(6912);K.t1.register(...K.$L);var R={name:"CO2Chart",props:{co2Data:{type:Array,required:!0},timestamps:{type:Array,required:!0}},setup(e){const t=(0,j.KR)(null);return(0,r.sV)((()=>{const a=document.getElementById("co2Chart").getContext("2d");console.log(e.co2Data),t.value=new K.t1(a,{type:"line",data:{labels:e.timestamps,datasets:[{label:"CO2 Levels (ppm)",data:e.co2Data,borderColor:"rgba(75, 192, 192, 1)",backgroundColor:"rgba(75, 192, 192, 0.2)",borderWidth:2,fill:!0}]},options:{responsive:!0,scales:{x:{title:{display:!0,text:"Time"}},y:{title:{display:!0,text:"CO2 Levels (ppm)"},beginAtZero:!0}}}})})),(0,r.xo)((()=>{t.value&&t.value.destroy()})),{co2Chart:t}}},W=a(1241);const F=(0,W.A)(R,[["render",H]]);var I=F,Q={name:"App",components:{CO2Chart:I},setup(){const e="george_dudnik",t="7355608Egor$",a=btoa(`${e}:${t}`),l=(0,j.KR)([]),n=(0,j.KR)([]),i=(0,j.KR)(null),o=10,c=(0,j.KR)(1),s=(0,j.KR)(!1),d=async e=>{try{const t=await X.A.get(`https://console.beringar.co.uk/privateapi/device/cache/${e.detail.deviceid}/`,{headers:{Authorization:`Basic ${a}`}});e.deviceCache=t.data}catch(t){console.error("Error fetching device cache:",t)}},u=async e=>{s.value=!0;try{const t=await X.A.get(`https://console.beringar.co.uk/privateapi/sensorlatest/building/${e}/`,{headers:{Authorization:`Basic ${a}`}});l.value=t.data,await Promise.all(l.value.map((e=>d(e)))),console.log("All device caches fetched")}catch(t){console.error("Error fetching protected data:",t)}},p=async()=>{try{const e=await X.A.get("https://console.beringar.co.uk/privateapi/building/",{headers:{Authorization:`Basic ${a}`}});console.log(e.data),n.value=e.data}catch(e){console.error("Error fetching building data:",e)}};(0,r.sV)(p),(0,r.sV)(u);const v=()=>{i.value&&u(i.value)},g=(0,r.EW)((()=>{const e=l.value.map((e=>e.detail.temperature)).filter(Boolean),t=e.reduce(((e,t)=>e+t),0);return t/e.length||0})),k=(0,r.EW)((()=>{const e=l.value.map((e=>e.detail.humid)).filter(Boolean),t=e.reduce(((e,t)=>e+t),0);return t/e.length||0})),h=(0,r.EW)((()=>{const e=l.value.map((e=>e.detail.co2)).filter(Boolean);return Math.max(...e)||0})),m=(0,r.EW)((()=>Math.ceil(l.value.length/o))),L=(0,r.EW)((()=>{const e=(c.value-1)*o,t=e+o;return l.value.slice(e,t)})),f=(0,r.EW)((()=>l.value?l.value.map((e=>e.detail.co2)):[])),b=(0,r.EW)((()=>l.value?l.value.map((e=>y(e.updated))):[])),y=e=>{const t=new Date(e),a=t.getFullYear(),l=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0"),n=String(t.getHours()).padStart(2,"0"),i=String(t.getMinutes()).padStart(2,"0"),o=String(t.getSeconds()).padStart(2,"0");return`${a}-${l}-${r} ${n}:${i}:${o}`};return{data:l,buildings:n,currentPage:c,itemsPerPage:o,averageTemperature:g,averageHumidity:k,maxCO2:h,totalPages:m,paginatedData:L,co2Data:f,timestamps:b,formatDate:y,selectedBuilding:i,filterByBuilding:v}}};const U=(0,W.A)(Q,[["render",T]]);var Y=U,q=a(5768);const V=(0,l.Ef)(Y);V.use(q["default"]),V.use(q.IconsPlugin),V.mount("#app")}},t={};function a(l){var r=t[l];if(void 0!==r)return r.exports;var n=t[l]={exports:{}};return e[l].call(n.exports,n,n.exports,a),n.exports}a.m=e,function(){var e=[];a.O=function(t,l,r,n){if(!l){var i=1/0;for(d=0;d<e.length;d++){l=e[d][0],r=e[d][1],n=e[d][2];for(var o=!0,c=0;c<l.length;c++)(!1&n||i>=n)&&Object.keys(a.O).every((function(e){return a.O[e](l[c])}))?l.splice(c--,1):(o=!1,n<i&&(i=n));if(o){e.splice(d--,1);var s=r();void 0!==s&&(t=s)}}return t}n=n||0;for(var d=e.length;d>0&&e[d-1][2]>n;d--)e[d]=e[d-1];e[d]=[l,r,n]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var l in t)a.o(t,l)&&!a.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:t[l]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};a.O.j=function(t){return 0===e[t]};var t=function(t,l){var r,n,i=l[0],o=l[1],c=l[2],s=0;if(i.some((function(t){return 0!==e[t]}))){for(r in o)a.o(o,r)&&(a.m[r]=o[r]);if(c)var d=c(a)}for(t&&t(l);s<i.length;s++)n=i[s],a.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return a.O(d)},l=self["webpackChunkberingar_analytics"]=self["webpackChunkberingar_analytics"]||[];l.forEach(t.bind(null,0)),l.push=t.bind(null,l.push.bind(l))}();var l=a.O(void 0,[504],(function(){return a(190)}));l=a.O(l)})();
//# sourceMappingURL=app.ce72dacf.js.map